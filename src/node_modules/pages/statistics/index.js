import React, {useState, useEffect} from 'react'
import useFetch from "hooks/useFetch";

const Statistics = () => {
    const apiUrl = '/statistics'
    const [{isLoading, error, response}, doFetch] = useFetch(apiUrl)
    const [fromDate, setFromDate] = useState('2022-05-10')
    const [tillDate, setTillDate] = useState('2022-09-04')
    const [proteinA, setProteinA] = useState(0)
    const [proteinV, setProteinV] = useState(0)
    const [fatsA, setFatsA] = useState(0)
    const [fatsV, setFatsV] = useState(0)
    const [carbohydratesF, setCarbohydratesF] = useState(0)
    const [carbohydratesS, setCarbohydratesS] = useState(0)
    const [calories, setCalories] = useState(0)

    const handleSubmit = event => {
        event.preventDefault()

        const data = {
            dateStart: fromDate,
            dateFinish: tillDate,
            name: 'Dmytro'
        }

        doFetch({
            method: 'post',
            data
        })
    }

    useEffect(() => {
        if (!response) {
            return
        }

        setProteinA(response.protein_a)
        setProteinV(response.protein_v)
        setFatsA(response.fats_a)
        setFatsV(response.fats_v)
        setCarbohydratesF(response.carbohydrates_f)
        setCarbohydratesS(response.carbohydrates_s)
        setCalories(response.calories)
    }, [response])

    return (
        <div className="container text-center">
            <form  onSubmit={handleSubmit}>
                <fieldset>
                    <fieldset className="form-group">
                        <input
                            type="text"
                            className="form-control"
                            placeholder="from"
                            value={fromDate}
                            onChange={e => setFromDate(e.target.value)}
                        />
                    </fieldset>
                    <fieldset className="form-group">
                        <input
                            type="text"
                            className="form-control"
                            placeholder="till"
                            aria-label="till"
                            value={tillDate}
                            onChange={e => setTillDate(e.target.value)}
                        />
                    </fieldset>
                    <button
                        className="btn btn-lg btn-success"
                        type="submit"
                    >
                        Button
                    </button>
                </fieldset>
            </form>
            <table className="table">
                <tbody>
                <tr>
                    <td>from Date</td>
                    <td>till Date</td>
                    <td>Animal protein</td>
                    <td>Vegetable protein</td>
                    <td>Animal fat</td>
                    <td>Vegetable fat</td>
                    <td>Fast carbohydrates</td>
                    <td>Slow carbohydrates</td>
                    <td>Calories</td>
                </tr>
                <tr>
                    <td>{fromDate}</td>
                    <td>{tillDate}</td>
                    <td>{proteinA}</td>
                    <td>{proteinV}</td>
                    <td>{fatsA}</td>
                    <td>{fatsV}</td>
                    <td>{carbohydratesF}</td>
                    <td>{carbohydratesS}</td>
                    <td>{calories}</td>
                </tr>
                </tbody>
            </table>
        </div>
    )
}

export default Statistics
